<%- include('../partials/header') %>

<h1>Products</h1>

<form method="GET" action="/products">
  <input type="text" name="q" value="<%= filterQ %>" placeholder="Search name">
  <select name="supplier">
    <option value="">--All--</option>
    <% suppliers.forEach(s => { %>
      <option value="<%= s._id %>"><%= s.name %></option>
    <% }) %>
  </select>
  <button>Search</button>
</form>

<% if(currentUser){ %>
  <a href="/products/new">New Product</a>
<% } %>

<ul>
  <!-- Header row -->
  <li>
    <strong style="display: inline-block; width: 150px;">Name</strong>
    <strong style="display: inline-block; width: 80px;">Price</strong>
    <strong style="display: inline-block; width: 60px;">Qty</strong>
    <strong style="display: inline-block; width: 150px;">Supplier</strong>
    <% if(currentUser){ %>
      <strong>Actions</strong>
    <% } %>
  </li>

  <% products.forEach(p => { %>
    <li>
      <span style="display: inline-block; width: 150px;"><%= p.name %></span>
      <span style="display: inline-block; width: 80px;"><%= p.price %></span>
      <span style="display: inline-block; width: 60px;"> <%= p.quantity %> </span>
      <span style="display: inline-block; width: 150px;"><%= p.supplier ? p.supplier.name : '' %></span>
      <% if(currentUser){ %>
        <span>
          <a href="/products/<%= p._id %>/edit">Edit</a>
          <form action="/products/<%= p._id %>?_method=DELETE" method="POST" style="display:inline">
            <button>Delete</button>
          </form>
        </span>
      <% } %>
    </li>
  <% }) %>
</ul>

<%- include('../partials/footer') %>
