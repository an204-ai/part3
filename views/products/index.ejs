<%- include('../partials/header') %>
<h1>Products</h1>

<form method="GET" action="/products">
  <input type="text" name="q" value="<%= filterQ %>" placeholder="Search name">
  <select name="supplier">
    <option value="">--All--</option>
    <% suppliers.forEach(s => { %>
      <option value="<%= s._id %>"><%= s.name %></option>
    <% }) %>
  </select>
  <button>Search</button>
</form>

<% if(currentUser){ %>
  <a href="/products/new">New Product</a>
<% } %>

<ul>
  <% products.forEach(p => { %>
    <li>
      <strong><%= p.name %></strong> - <%= p.price %> - qty: <%= p.quantity %>
      <% if(p.supplier){ %> (Supplier: <%= p.supplier.name %>) <% } %>
      <% if(currentUser){ %>
        <a href="/products/<%= p._id %>/edit">Edit</a>
        <form action="/products/<%= p._id %>?_method=DELETE" method="POST" style="display:inline">
          <button>Delete</button>
        </form>
      <% } %>
    </li>
  <% }) %>
</ul>

<%- include('../partials/footer') %>
